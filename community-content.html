<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>品牌活动 - 怡亚科技</title>
    <link rel="stylesheet" href="footer.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="blog.css">

</head>
<body>

    <!-- 头部占位符 -->
    <div id="header-placeholder"></div>

    <main>
        <h1 class="page-title">品牌活动</h1>
        <div id="article-list">
            <!-- 文章列表将由JavaScript动态生成在这里 -->
        </div>
    </main>

    <!-- 脚部占位符 -->
    <div id="footer-placeholder"></div>

    <script>
        // 封装一个函数用于加载HTML片段
        function loadComponent(url, elementId) {
            return fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok for ' + url);
                    }
                    return response.text();
                })
                .then(data => {
                    const element = document.getElementById(elementId);
                    if (element) {
                        element.innerHTML = data;
                    } else {
                        console.error('Element with id "' + elementId + '" not found.');
                    }
                })
                .catch(error => {
                    console.error('Failed to load component:', error);
                    const element = document.getElementById(elementId);
                    if (element) {
                        element.innerHTML = `<p style="color:red; text-align:center;">Error loading content from ${url}.</p>`;
                    }
                });
        }

        // 页面加载完成后执行
        document.addEventListener("DOMContentLoaded", function() {
            // 1. 加载头部和脚部
            Promise.all([
                loadComponent('header.html', 'header-placeholder'),
                loadComponent('footer.html', 'footer-placeholder')
            ]);

            // 2. 加载并显示文章列表
            fetch('articles-index.json')
                .then(response => response.json())
                .then(articles => {
                    const articleListContainer = document.getElementById('article-list');
                    if (!articleListContainer) return;

                    if (articles.length === 0) {
                        articleListContainer.innerHTML = '<p>暂无文章。</p>';
                        return;
                    }

                    // 对文章按日期倒序排序
                    articles.sort((a, b) => new Date(b.date) - new Date(a.date));

                    let articlesHTML = '';
                    articles.forEach(article => {
                        articlesHTML += `
                            <article class="article-entry">
                                <h2><a href="article.html?id=${article.id}">${article.title}</a></h2>
                                <p class="article-meta">发布于 ${article.date}</p>
                                <p class="article-summary">${article.summary}</p>
                                <a href="article.html?id=${article.id}" class="read-more">阅读全文 &rarr;</a>
                            </article>
                        `;
                    });
                    articleListContainer.innerHTML = articlesHTML;
                })
                .catch(error => {
                    console.error('加载文章列表失败:', error);
                    const articleListContainer = document.getElementById('article-list');
                    if (articleListContainer) {
                        articleListContainer.innerHTML = '<p>无法加载文章列表，请稍后再试。</p>';
                    }
                });
        });
    </script>

</body>
</html>