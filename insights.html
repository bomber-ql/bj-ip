<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨åŸŸæ™ºèƒ½è¥é”€æ´å¯Ÿ - æ€¡äºšç§‘æŠ€</title>
    <link rel="stylesheet" href="footer.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="blog.css">
    
</head>
<body>

    <!-- å¤´éƒ¨å ä½ç¬¦ -->
    <div id="header-placeholder"></div>

    <main>
         <div class="content-container">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <h1 class="page-title">å…¨åŸŸæ™ºèƒ½æ´å¯Ÿ</h1>  </div>
        <!-- å…¨å±æ¨ªå¹…å®¹å™¨ -->
        <div class="title-banner">
            <iframe src="3d.html" class="banner-iframe" title="3Dæ™ºèƒ½æ•°æ®å¯è§†åŒ–"></iframe>
        </div>

        <!-- åˆ†ç±»å¯¼èˆªæŒ‰é’® -->
        <div class="category-nav">
            <button class="category-btn active" onclick="filterArticlesByCategory('æ•°æ®æ´å¯Ÿ')">ğŸ“Š æ•°æ®æ´å¯Ÿ</button>
            <button class="category-btn" onclick="filterArticlesByCategory('å“ç‰Œç­–ç•¥')">ğŸ¯ å“ç‰Œç­–ç•¥</button>
            <button class="category-btn" onclick="filterArticlesByCategory('å“ç‰Œæ´»åŠ¨')">ğŸª å“ç‰Œæ´»åŠ¨</button>
        </div>

        <!-- ç­›é€‰ä¿¡æ¯æ˜¾ç¤º -->
        <div class="filter-info" id="filterInfo">
            æ­£åœ¨åŠ è½½å…¨åŸŸæ™ºèƒ½æ´å¯Ÿç›¸å…³æ–‡ç« ...
        </div>

        <div id="article-list">
            <!-- æ–‡ç« åˆ—è¡¨å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆåœ¨è¿™é‡Œ -->
        </div>
    </main>

    <!-- è„šéƒ¨å ä½ç¬¦ -->
    <div id="footer-placeholder"></div>

    <script>
        // æ‚¨ç°æœ‰çš„JavaScriptä»£ç ä¿æŒä¸å˜...
        // å°è£…ä¸€ä¸ªå‡½æ•°ç”¨äºåŠ è½½HTMLç‰‡æ®µ
        function loadComponent(url, elementId) {
            return fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok for ' + url);
                    }
                    return response.text();
                })
                .then(data => {
                    const element = document.getElementById(elementId);
                    if (element) {
                        element.innerHTML = data;
                    } else {
                        console.error('Element with id "' + elementId + '" not found.');
                    }
                })
                .catch(error => {
                    console.error('Failed to load component:', error);
                    const element = document.getElementById(elementId);
                    if (element) {
                        element.innerHTML = `<p style="color:red; text-align:center;">Error loading content from ${url}.</p>`;
                    }
                });
        }

        let allArticles = []; // å­˜å‚¨æ‰€æœ‰æ–‡ç« æ•°æ®
        let currentCategory = 'æ•°æ®æ´å¯Ÿ'; // å½“å‰é€‰ä¸­çš„åˆ†ç±»

        // æŒ‰åˆ†ç±»ç­›é€‰æ–‡ç« 
        function filterArticlesByCategory(category) {
            currentCategory = category;
            
            // æ›´æ–°æŒ‰é’®æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            filterArticles(allArticles);
        }

        // ç­›é€‰æ–‡ç« 
        function filterArticles(articles) {
            const articleListContainer = document.getElementById('article-list');
            const filterInfo = document.getElementById('filterInfo');
            
            // æ ¹æ®å½“å‰åˆ†ç±»ç­›é€‰
            const filteredArticles = articles.filter(article => 
                article.tags && article.tags.includes(currentCategory)
            );
            
            filterInfo.textContent = `æ˜¾ç¤º"${currentCategory}"ç›¸å…³æ–‡ç« ï¼Œå…± ${filteredArticles.length} ç¯‡`;
            filterInfo.style.display = filteredArticles.length > 0 ? 'block' : 'none';
            
            displayArticles(filteredArticles);
        }

        // æ˜¾ç¤ºæ–‡ç« åˆ—è¡¨
        function displayArticles(articles) {
            const articleListContainer = document.getElementById('article-list');
            
            if (articles.length === 0) {
                articleListContainer.innerHTML = `
                    <div class="no-articles">
                        <p>æš‚æ— ${currentCategory}ç›¸å…³æ–‡ç« ã€‚</p>
                        <p>è¯·æ£€æŸ¥æ–‡ç« æ˜¯å¦å·²æ·»åŠ "${currentCategory}"æ ‡ç­¾ã€‚</p>
                    </div>
                `;
                return;
            }

            // å¯¹æ–‡ç« æŒ‰æ—¥æœŸå€’åºæ’åº
            articles.sort((a, b) => new Date(b.date) - new Date(a.date));

            let articlesHTML = '';
            articles.forEach(article => {
                // æ ¹æ®åˆ†ç±»æ˜¾ç¤ºå¯¹åº”çš„æ ‡ç­¾æ ·å¼
                let categoryTag = '';
                if (article.tags && article.tags.includes(currentCategory)) {
                    let tagClass = '';
                    if (currentCategory === 'æ•°æ®æ´å¯Ÿ') tagClass = 'data-insight-tag';
                    else if (currentCategory === 'å“ç‰Œç­–ç•¥') tagClass = 'brand-strategy-tag';
                    else if (currentCategory === 'å“ç‰Œæ´»åŠ¨') tagClass = 'brand-activity-tag';
                    
                    categoryTag = `<div class="article-tags"><span class="article-tag ${tagClass}">${currentCategory}</span></div>`;
                }
                
                articlesHTML += `
                    <article class="article-entry">
                        <h2><a href="article.html?id=${article.id}">${article.title}</a></h2>
                        <p class="article-meta">å‘å¸ƒäº ${article.date} | ä½œè€…: ${article.author || 'æ€¡äºšç§‘æŠ€'}</p>
                        ${categoryTag}
                        <p class="article-summary">${article.summary}</p>
                        <a href="article.html?id=${article.id}" class="read-more">é˜…è¯»å…¨æ–‡ &rarr;</a>
                    </article>
                `;
            });
            articleListContainer.innerHTML = articlesHTML;
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener("DOMContentLoaded", function() {
            // 1. åŠ è½½å¤´éƒ¨å’Œè„šéƒ¨
            Promise.all([
                loadComponent('header.html', 'header-placeholder'),
                loadComponent('footer.html', 'footer-placeholder')
            ]);

            // 2. åŠ è½½å¹¶æ˜¾ç¤ºæ–‡ç« åˆ—è¡¨
            fetch('articles-index.json')
                .then(response => response.json())
                .then(articles => {
                    allArticles = articles;
                    // é»˜è®¤æ˜¾ç¤º"æ•°æ®æ´å¯Ÿ"åˆ†ç±»
                    filterArticles(articles);
                })
                .catch(error => {
                    console.error('åŠ è½½æ–‡ç« åˆ—è¡¨å¤±è´¥:', error);
                    const articleListContainer = document.getElementById('article-list');
                    const filterInfo = document.getElementById('filterInfo');
                    if (articleListContainer) {
                        articleListContainer.innerHTML = '<p>æ— æ³•åŠ è½½æ–‡ç« åˆ—è¡¨ï¼Œè¯·ç¨åå†è¯•ã€‚</p>';
                    }
                    if (filterInfo) {
                        filterInfo.textContent = 'åŠ è½½æ–‡ç« åˆ—è¡¨å¤±è´¥';
                    }
                });
        });

        // ç¡®ä¿å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸ
        window.filterArticlesByCategory = function(category) {
            console.log('filterArticlesByCategoryè¢«è°ƒç”¨ï¼Œåˆ†ç±»:', category);
            
            currentCategory = category;
            
            // æ›´æ–°æŒ‰é’®æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(category)) {
                    btn.classList.add('active');
                }
            });
            
            filterArticles(allArticles);
        };

        // åœ¨insights.htmlçš„ç°æœ‰JavaScriptä»£ç ä¸­æ·»åŠ URLå‚æ•°å¤„ç†
        function handleURLParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const category = urlParams.get('category');
            
            if (category === 'strategy') {
                currentCategory = 'å“ç‰Œç­–ç•¥';
            } else if (category === 'activities') {
                currentCategory = 'å“ç‰Œæ´»åŠ¨';
            } else {
                currentCategory = 'æ•°æ®æ´å¯Ÿ';
            }
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            updateCategoryButtons();
            
            // ç­›é€‰æ–‡ç« 
            if (window.allArticles && window.allArticles.length > 0) {
                filterArticles(window.allArticles);
            }
        }

        // æ›´æ–°åˆ†ç±»æŒ‰é’®çŠ¶æ€
        function updateCategoryButtons() {
            const buttons = document.querySelectorAll('.category-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(currentCategory)) {
                    btn.classList.add('active');
                }
            });
        }

        // åœ¨é¡µé¢åŠ è½½å®Œæˆåè°ƒç”¨
        document.addEventListener("DOMContentLoaded", function() {
            // å¤„ç†URLå‚æ•°
            handleURLParameters();
        });
    </script>

</body>
</html>